     1                                  SECTION .sys_tables
     2                                  ; Direcciones LMA y VMA
     3                                  EXTERN __SYS_TABLES_LMA
     4                                  EXTERN __TECLADO_ISR_VMA
     5                                  ; Etiquetas globales
     6                                  GLOBAL  DS_SEL_00
     7                                  GLOBAL  CS_SEL_00
     8                                  GLOBAL  DS_SEL_11
     9                                  GLOBAL  CS_SEL_11
    10                                  GLOBAL  TSS_SEL
    11                                  GLOBAL  _gdtr_32
    12                                  GLOBAL  _idtr_32
    13                                  ; Parte baja de direcciones de los handlers
    14                                  EXTERN L_ISR00_Handler_DE
    15                                  EXTERN L_ISR01_Handler_DB
    16                                  EXTERN L_ISR02_Handler_NMI
    17                                  EXTERN L_ISR03_Handler_BP
    18                                  EXTERN L_ISR04_Handler_OF
    19                                  EXTERN L_ISR05_Handler_BR
    20                                  EXTERN L_ISR06_Handler_UD
    21                                  EXTERN L_ISR07_Handler_NM
    22                                  EXTERN L_ISR08_Handler_DF
    23                                  EXTERN L_ISR10_Handler_TS
    24                                  EXTERN L_ISR11_Handler_NP
    25                                  EXTERN L_ISR12_Handler_SS
    26                                  EXTERN L_ISR13_Handler_GP
    27                                  EXTERN L_ISR14_Handler_PF
    28                                  EXTERN L_ISR16_Handler_MF
    29                                  EXTERN L_ISR17_Handler_AC
    30                                  EXTERN L_ISR18_Handler_MC
    31                                  EXTERN L_ISR19_Handler_XM
    32                                  EXTERN L_IRQ00_Handler
    33                                  EXTERN L_IRQ01_Handler
    34                                  EXTERN L_ISR128_Handler_SC
    35                                  ; Parte alta de las direcciones de los Handlers
    36                                  H_ISRXX_Handler     EQU 0x0010
    37                                  
    38                                  ;-------------------GDT 32 BITS ----------------
    39                                  ;Cada descriptor tiene 8 bytes.
    40                                  GDT_32:
    41                                  NULL_SEL    equ $-GDT_32       ;Indice de GDT = 0x00
    42 00000000 0000000000000000            dq 0x0
    43                                  
    44                                  CS_SEL_16       equ $-GDT_32       ;0x08
    45 00000008 FFFF                        dw 0xFFFF       ;Limit 15-0
    46 0000000A 0000                        dw 0x0000       ;Base 15-0
    47 0000000C FF                          db 0xFF         ;Base 23-16
    48 0000000D 99                          db 10011001b    ;Atributos:
    49                                                      ;P
    50                                                      ;DPL
    51                                                      ;S
    52                                                      ;D/C
    53                                                      ;ED/C
    54                                                      ;R/w
    55                                                      ;A
    56 0000000E 40                          db 01000000b    ;Limit
    57                                                      ;G
    58                                                      ;D/B
    59                                                      ;L
    60                                                      ;AVL
    61 0000000F FF                          db 0xFF         ;Base 31-24
    62                                  
    63                                  CS_SEL_00   equ $-GDT_32       ;Indice de GDT = 0x10
    64 00000010 FFFF                        dw 0xFFFF       ;Limit 15-0
    65 00000012 0000                        dw 0x0000       ;Base 15-0
    66 00000014 00                          db 0x00         ;Base 23-16
    67 00000015 99                          db 10011001b    ;Atributos:                   
    68                                                          ;P=1 Presente en el segmento
    69                                                          ;DPL=00 Privilegio nivel 0 - Kernel
    70                                                          ;S=1 Descriptor de Codigo/Datos        
    71                                                          ;D/C=1 Segmento de Codigo 
    72                                                          ;C=0 No puede ser invocado
    73                                                          ;R=0 No legible
    74                                                          ;A=1 por defecto Accedido
    75 00000016 CF                          db 11001111b    ;Limit 19-16 (Parte baja)
    76                                                      ;Parte alta:
    77                                                          ;G=1 Maximo offset = Limite*0x1000+0xFFF
    78                                                          ;D/B=1 Big, Segmento de 32
    79                                                          ;L=0 No 64 bits nativo
    80                                                          ;AVL=0 No utilizado
    81 00000017 00                          db 0x00         ;Base
    82                                  DS_SEL_00      equ $-GDT_32       ;Indice de GDT = 0x20
    83 00000018 FFFF                        dw 0xFFFF       ;Limit 15-0
    84 0000001A 0000                        dw 0x0000       ;Base 15-0
    85 0000001C 00                          db 0x00         ;Base 23-16
    86 0000001D 92                          db 10010010b    ;Atributos:
    87                                                          ;P=1 Presente en el segmento
    88                                                          ;DPL=00 Privilegio nivel 0 - Kernel
    89                                                          ;S=1 Descriptor de Codigo/Datos                        
    90                                                          ;D/C=0 Segmento de Datos 
    91                                                          ;ED=0 Segmento de datos comun
    92                                                          ;W=1 Escribible
    93                                                          ;A=0 por defecto No Accedido
    94 0000001E CF                          db 11001111b    ;Limit
    95                                                      ;G
    96                                                      ;D/B
    97                                                      ;L
    98                                                      ;AVL
    99 0000001F 00                          db 0x00         ;Base
   100                                  
   101                                  CS_SEL_11      equ $-GDT_32       ;Indice de GDT = 0x30
   102 00000020 FFFF                        dw 0xFFFF       ;Limit 15-0
   103 00000022 0000                        dw 0x0000       ;Base 15-0
   104 00000024 00                          db 0x00         ;Base 23-16
   105 00000025 FA                          db 11111010b    ;Atributos:
   106                                                          ;P=1 Presente en el segmento
   107                                                          ;DPL=11   nivel 3 - Usuario
   108                                                          ;S=1 Descriptor de Codigo/Datos                        
   109                                                          ;D/C=1 Segmento de Código 
   110                                                          ;ED=0 Segmento de datos comun
   111                                                          ;R=1 Legible
   112                                                          ;A=0 por defecto No Accedido
   113 00000026 CF                          db 11001111b    ;Limit
   114                                                      ;G
   115                                                      ;D/B
   116                                                      ;L
   117                                                      ;AVL
   118 00000027 00                          db 0x00         ;Base
   119                                  
   120                                  
   121                                  DS_SEL_11      equ $-GDT_32       ;Indice de GDT = 0x20
   122 00000028 FFFF                        dw 0xFFFF       ;Limit 15-0
   123 0000002A 0000                        dw 0x0000       ;Base 15-0
   124 0000002C 00                          db 0x00         ;Base 23-16
   125 0000002D F2                          db 11110010b    ;Atributos:
   126                                                          ;P=1 Presente en el segmento
   127                                                          ;DPL=00 Privilegio nivel 0 - Kernel
   128                                                          ;S=1 Descriptor de Codigo/Datos                        
   129                                                          ;D/C=0 Segmento de Datos 
   130                                                          ;ED=0 Segmento de datos comun
   131                                                          ;W=1 Escribible
   132                                                          ;A=0 por defecto No Accedido
   133 0000002E CF                          db 11001111b    ;Limit
   134                                                      ;G
   135                                                      ;D/B
   136                                                      ;L
   137                                                      ;AVL
   138 0000002F 00                          db 0x00         ;Base
   139                                  
   140                                  
   141                                  TSS_SEL equ $-GDT_32          ;Base 0x00001000 Limite 0x00000067
   142 00000030 6700                        dw  0x0067                ;Limite del segmento(bits 15 -0)
   143 00000032 0010                        dw  0x1000                ;Base del segmento(bits 15-0)
   144 00000034 00                          db  0                     ;Base del segmento(bits 23-16)
   145 00000035 89                          db  10001001b             ; Atributos
   146                                                                    ; P=1 Presente en el segmento
   147                                                                    ; DPL = 00 Privilegio nivel 0 - Kernel
   148                                                                    ; S = 0 (Descriptor de TSS)
   149                                                                    ; TIPO = 1 0 B 1 siendo B = Busy y queda en 0 (Avaibable)
   150 00000036 00                          db  00000000b             ; G = 0, D/B = 0, L = 0 , AVL = 0 
   151                                                                ; Límite del segmento (bits 16 - 19)
   152 00000037 00                          db  0x00                  ; Base del segmento(bits 31-24)    
   153                                  
   154                                  
   155                                  GDT_LENGTH EQU $-GDT_32
   156                                  
   157                                  _gdtr_32:
   158 00000038 3700                        dw GDT_LENGTH-1
   159                                      ;dd 0x000FFD00 ; Base de la GDT en la section sys_tables. No van todas FFF al principio por el shadow.  
   160 0000003A [00000000]                  dd GDT_32 ; Base de la GDT en la section sys_tables. Use o32 cuando la cargo en init16.  
   161                                  
   162                                  
   163                                  ;-------------------------IDT 32 BITS---------------------
   164                                  
   165                                  ; Cada descriptor tiene 8 bytes.
   166                                  IDT:
   167                                  ; Divide Error
   168                                  ISR00_IDT   EQU $-IDT   
   169 0000003E [0000]                      dw L_ISR00_Handler_DE                       ; 2 bytes - Offset 15-0 - Segmento de referencia al código de la EXCEPTION 
   170                                  
   171 00000040 1000                        dw CS_SEL_00                                ; 2 bytes - Selector de segmento de código
   172                                  
   173 00000042 00                          db 00000000b                                ; 1 byte - 000 e indefinido
   174 00000043 8F                          db 10001111b                                ; 1 byte - Atributos
   175                                                                                      ; P = 1 (Presente en el segmento)
   176                                                                                      ; DPL = 00 (Nivel de privilegio priotidad Kernel)
   177                                                                                      ; S = 0 (Descriptor de sistema)
   178                                                                                      ; TIPO = 1111 (Puerta de Excepcion de 32 bits 80386 - Trap Gate)
   179 00000044 1000                        dw H_ISRXX_Handler       ; 2 bytes - Offset 31-16 - Segmento de referencia al código de la EXCEPTION 
   180                                  ; Debug Exceptions - Reservada 
   181                                  ISR01_IDT   EQU $-IDT   
   182 00000046 0000000000000000            dq 0x0
   183                                  ; NMI
   184                                  ISR02_IDT   EQU $-IDT   
   185                                  
   186 0000004E [0000]                      dw L_ISR02_Handler_NMI                      ; 2 bytes - Offset 15-0 - Segmento de referencia al código de la EXCEPTION 
   187 00000050 1000                        dw CS_SEL_00                                ; 2 bytes - Selector de segmento de código
   188                                  
   189 00000052 00                          db 00000000b                                ; 1 byte - 000 e indefinido
   190 00000053 8F                          db 10001111b                                ; 1 byte - Atributos
   191                                                                                      ; P = 1 (Presente en el segmento)
   192                                                                                      ; DPL = 00 (Nivel de privilegio priotidad Kernel)
   193                                                                                      ; S = 0 (Descriptor de sistema)
   194                                                                                      ; TIPO = 1111 (Puerta de Excepcion de 32 bits 80386 - Trap Gate)
   195 00000054 1000                        dw H_ISRXX_Handler                          ; 2 bytes - Offset 31-16 - Segmento de referencia al código de la EXCEPTION 
   196                                  ; Breakpoint
   197                                  ISR03_IDT   EQU $-IDT   
   198 00000056 [0000]                      dw L_ISR03_Handler_BP                       ; 2 bytes - Offset 15-0 - Segmento de referencia al código de la EXCEPTION 
   199 00000058 1000                        dw CS_SEL_00                                ; 2 bytes - Selector de segmento de código
   200                                  
   201 0000005A 00                          db 00000000b                                ; 1 byte - 000 e indefinido
   202 0000005B 8F                          db 10001111b                                ; 1 byte - Atributos
   203                                                                                      ; P = 1 (Presente en el segmento)
   204                                                                                      ; DPL = 00 (Nivel de privilegio priotidad Kernel)
   205                                                                                      ; S = 0 (Descriptor de sistema)
   206                                                                                      ; TIPO = 1111 (Puerta de Excepcion de 32 bits 80386 - Trap Gate)
   207 0000005C 1000                        dw H_ISRXX_Handler                           ; 2 bytes - Offset 31-16 - Segmento de referencia al código de la EXCEPTION 
   208                                  ; Overflow
   209                                  ISR04_IDT   EQU $-IDT   
   210 0000005E [0000]                      dw L_ISR04_Handler_OF                       ; 2 bytes - Offset 15-0 - Segmento de referencia al código de la EXCEPTION 
   211 00000060 1000                        dw CS_SEL_00                                ; 2 bytes - Selector de segmento de código
   212                                  
   213 00000062 00                          db 00000000b                                ; 1 byte - 000 e indefinido
   214 00000063 8F                          db 10001111b                                ; 1 byte - Atributos
   215                                                                                      ; P = 1 (Presente en el segmento)
   216                                                                                      ; DPL = 00 (Nivel de privilegio priotidad Kernel)
   217                                                                                      ; S = 0 (Descriptor de sistema)
   218                                                                                      ; TIPO = 1111 (Puerta de Excepcion de 32 bits 80386 - Trap Gate)
   219 00000064 1000                        dw H_ISRXX_Handler                          ; 2 bytes - Offset 31-16 - Segmento de referencia al código de la EXCEPTION 
   220                                  ; BOUND Range Exceeded
   221                                  ISR05_IDT   EQU $-IDT   
   222 00000066 [0000]                      dw L_ISR05_Handler_BR                       ; 2 bytes - Offset 15-0 - Segmento de referencia al código de la EXCEPTION 
   223 00000068 1000                        dw CS_SEL_00                                ; 2 bytes - Selector de segmento de código
   224                                  
   225 0000006A 00                          db 00000000b                                ; 1 byte - 000 e indefinido
   226 0000006B 8F                          db 10001111b                                ; 1 byte - Atributos
   227                                                                                      ; P = 1 (Presente en el segmento)
   228                                                                                      ; DPL = 00 (Nivel de privilegio priotidad Kernel)
   229                                                                                      ; S = 0 (Descriptor de sistema)
   230                                                                                      ; TIPO = 1111 (Puerta de Excepcion de 32 bits 80386 - Trap Gate)
   231 0000006C 1000                        dw H_ISRXX_Handler                          ; 2 bytes - Offset 31-16 - Segmento de referencia al código de la EXCEPTION 
   232                                  ; Invalid Opcode (Undefined Opcode)
   233                                  ISR06_IDT   EQU $-IDT   
   234 0000006E [0000]                      dw L_ISR06_Handler_UD                       ; 2 bytes - Offset 15-0 - Segmento de referencia al código de la EXCEPTION 
   235 00000070 1000                        dw CS_SEL_00                                ; 2 bytes - Selector de segmento de código
   236                                  
   237 00000072 00                          db 00000000b                                ; 1 byte - 000 e indefinido
   238 00000073 8F                          db 10001111b                                ; 1 byte - Atributos
   239                                                                                      ; P = 1 (Presente en el segmento)
   240                                                                                      ; DPL = 00 (Nivel de privilegio priotidad Kernel)
   241                                                                                      ; S = 0 (Descriptor de sistema)
   242                                                                                      ; TIPO = 1111 (Puerta de Excepcion de 32 bits 80386 - Trap Gate)
   243 00000074 1000                        dw H_ISRXX_Handler                          ; 2 bytes - Offset 31-16 - Segmento de referencia al código de la EXCEPTION 
   244                                  ; Device Not Available (No Math Coprocessor)
   245                                  ISR07_IDT   EQU $-IDT   
   246 00000076 [0000]                      dw L_ISR07_Handler_NM                       ; 2 bytes - Offset 15-0 - Segmento de referencia al código de la EXCEPTION 
   247 00000078 1000                        dw CS_SEL_00                                ; 2 bytes - Selector de segmento de código
   248                                  
   249 0000007A 00                          db 00000000b                                ; 1 byte - 000 e indefinido
   250 0000007B 8F                          db 10001111b                                ; 1 byte - Atributos
   251                                                                                      ; P = 1 (Presente en el segmento)
   252                                                                                      ; DPL = 00 (Nivel de privilegio priotidad Kernel)
   253                                                                                      ; S = 0 (Descriptor de sistema)
   254                                                                                      ; TIPO = 1111 (Puerta de Excepcion de 32 bits 80386 - Trap Gate)
   255 0000007C 1000                        dw H_ISRXX_Handler                          ; 2 bytes - Offset 31-16 - Segmento de referencia al código de la EXCEPTION
   256                                  ; Double Fault
   257                                  ISR08_IDT   EQU $-IDT   
   258 0000007E [0000]                      dw L_ISR08_Handler_DF                       ; 2 bytes - Offset 15-0 - Segmento de referencia al código de la EXCEPTION 
   259 00000080 1000                        dw CS_SEL_00                                ; 2 bytes - Selector de segmento de código
   260                                  
   261 00000082 00                          db 00000000b                                ; 1 byte - 000 e indefinido
   262 00000083 8F                          db 10001111b                                ; 1 byte - Atributos
   263                                                                                      ; P = 1 (Presente en el segmento)
   264                                                                                      ; DPL = 00 (Nivel de privilegio priotidad Kernel)
   265                                                                                      ; S = 0 (Descriptor de sistema)
   266                                                                                      ; TIPO = 1111 (Puerta de Excepcion de 32 bits 80386 - Trap Gate)
   267 00000084 1000                        dw H_ISRXX_Handler                          ; 2 bytes - Offset 31-16 - Segmento de referencia al código de la EXCEPTION
   268                                  ; Coprocessor Segment Overrun (reserved)
   269                                  ISR09_IDT   EQU $-IDT   
   270 00000086 0000000000000000            dq 0x0
   271                                  ; Invalid TSS
   272                                  ISR10_IDT   EQU $-IDT   
   273 0000008E [0000]                      dw L_ISR10_Handler_TS                       ; 2 bytes - Offset 15-0 - Segmento de referencia al código de la EXCEPTION 
   274 00000090 1000                        dw CS_SEL_00                                ; 2 bytes - Selector de segmento de código
   275                                  
   276 00000092 00                          db 00000000b                                ; 1 byte - 000 e indefinido
   277 00000093 8F                          db 10001111b                                ; 1 byte - Atributos
   278                                                                                      ; P = 1 (Presente en el segmento)
   279                                                                                      ; DPL = 00 (Nivel de privilegio priotidad Kernel)
   280                                                                                      ; S = 0 (Descriptor de sistema)
   281                                                                                      ; TIPO = 1111 (Puerta de Excepcion de 32 bits 80386 - Trap Gate)
   282 00000094 1000                        dw H_ISRXX_Handler                          ; 2 bytes - Offset 31-16 - Segmento de referencia al código de la EXCEPTION
   283                                  ; Segment Not Present
   284                                  ISR11_IDT   EQU $-IDT   
   285 00000096 [0000]                      dw L_ISR11_Handler_NP                       ; 2 bytes - Offset 15-0 - Segmento de referencia al código de la EXCEPTION 
   286 00000098 1000                        dw CS_SEL_00                                ; 2 bytes - Selector de segmento de código
   287                                  
   288 0000009A 00                          db 00000000b                                ; 1 byte - 000 e indefinido
   289 0000009B 8F                          db 10001111b                                ; 1 byte - Atributos
   290                                                                                      ; P = 1 (Presente en el segmento)
   291                                                                                      ; DPL = 00 (Nivel de privilegio priotidad Kernel)
   292                                                                                      ; S = 0 (Descriptor de sistema)
   293                                                                                      ; TIPO = 1111 (Puerta de Excepcion de 32 bits 80386 - Trap Gate)
   294 0000009C 1000                        dw H_ISRXX_Handler                          ; 2 bytes - Offset 31-16 - Segmento de referencia al código de la EXCEPTION
   295                                  ; Stack-Segment Fault
   296                                  ISR12_IDT   EQU $-IDT   
   297 0000009E [0000]                      dw L_ISR12_Handler_SS                       ; 2 bytes - Offset 15-0 - Segmento de referencia al código de la EXCEPTION 
   298 000000A0 1000                        dw CS_SEL_00                                ; 2 bytes - Selector de segmento de código
   299                                  
   300 000000A2 00                          db 00000000b                                ; 1 byte - 000 e indefinido
   301 000000A3 8F                          db 10001111b                                ; 1 byte - Atributos
   302                                                                                      ; P = 1 (Presente en el segmento)
   303                                                                                      ; DPL = 00 (Nivel de privilegio priotidad Kernel)
   304                                                                                      ; S = 0 (Descriptor de sistema)
   305                                                                                      ; TIPO = 1111 (Puerta de Excepcion de 32 bits 80386 - Trap Gate)
   306 000000A4 1000                        dw H_ISRXX_Handler                          ; 2 bytes - Offset 31-16 - Segmento de referencia al código de la EXCEPTION
   307                                  ; General Protection
   308                                  ISR13_IDT   EQU $-IDT   
   309 000000A6 [0000]                      dw L_ISR13_Handler_GP                       ; 2 bytes - Offset 15-0 - Segmento de referencia al código de la EXCEPTION 
   310 000000A8 1000                        dw CS_SEL_00                                ; 2 bytes - Selector de segmento de código
   311                                  
   312 000000AA 00                          db 00000000b                                ; 1 byte - 000 e indefinido
   313 000000AB 8F                          db 10001111b                                ; 1 byte - Atributos
   314                                                                                      ; P = 1 (Presente en el segmento)
   315                                                                                      ; DPL = 00 (Nivel de privilegio priotidad Kernel)
   316                                                                                      ; S = 0 (Descriptor de sistema)
   317                                                                                      ; TIPO = 1111 (Puerta de Excepcion de 32 bits 80386 - Trap Gate)
   318 000000AC 1000                        dw H_ISRXX_Handler                          ; 2 bytes - Offset 31-16 - Segmento de referencia al código de la EXCEPTION
   319                                  ; Page Fault
   320                                  ISR14_IDT   EQU $-IDT   
   321 000000AE [0000]                      dw L_ISR14_Handler_PF                       ; 2 bytes - Offset 15-0 - Segmento de referencia al código de la EXCEPTION 
   322 000000B0 1000                        dw CS_SEL_00                                ; 2 bytes - Selector de segmento de código
   323                                  
   324 000000B2 00                          db 00000000b                                ; 1 byte - 000 e indefinido
   325 000000B3 8F                          db 10001111b                                ; 1 byte - Atributos
   326                                                                                      ; P = 1 (Presente en el segmento)
   327                                                                                      ; DPL = 00 (Nivel de privilegio priotidad Kernel)
   328                                                                                      ; S = 0 (Descriptor de sistema)
   329                                                                                      ; TIPO = 1111 (Puerta de Excepcion de 32 bits 80386 - Trap Gate)
   330 000000B4 1000                        dw H_ISRXX_Handler                          ; 2 bytes - Offset 31-16 - Segmento de referencia al código de la EXCEPTION
   331                                  ; (Intel reserved. Do not use.)
   332                                  ISR15_IDT   EQU $-IDT   
   333 000000B6 0000000000000000            dq 0x0
   334                                  ; x87 FPU Floating-Point Error (Math Fault)
   335                                  ISR16_IDT   EQU $-IDT   
   336 000000BE [0000]                      dw L_ISR16_Handler_MF                       ; 2 bytes - Offset 15-0 - Segmento de referencia al código de la EXCEPTION 
   337 000000C0 1000                        dw CS_SEL_00                                ; 2 bytes - Selector de segmento de código
   338                                  
   339 000000C2 00                          db 00000000b                                ; 1 byte - 000 e indefinido
   340 000000C3 8F                          db 10001111b                                ; 1 byte - Atributos
   341                                                                                      ; P = 1 (Presente en el segmento)
   342                                                                                      ; DPL = 00 (Nivel de privilegio priotidad Kernel)
   343                                                                                      ; S = 0 (Descriptor de sistema)
   344                                                                                      ; TIPO = 1111 (Puerta de Excepcion de 32 bits 80386 - Trap Gate)
   345 000000C4 1000                        dw H_ISRXX_Handler                          ; 2 bytes - Offset 31-16 - Segmento de referencia al código de la EXCEPTION
   346                                  ; Alignment Check
   347                                  ISR17_IDT   EQU $-IDT   
   348 000000C6 [0000]                      dw L_ISR17_Handler_AC                       ; 2 bytes - Offset 15-0 - Segmento de referencia al código de la EXCEPTION 
   349 000000C8 1000                        dw CS_SEL_00                                ; 2 bytes - Selector de segmento de código
   350                                  
   351 000000CA 00                          db 00000000b                                ; 1 byte - 000 e indefinido
   352 000000CB 8F                          db 10001111b                                ; 1 byte - Atributos
   353                                                                                      ; P = 1 (Presente en el segmento)
   354                                                                                      ; DPL = 00 (Nivel de privilegio priotidad Kernel)
   355                                                                                      ; S = 0 (Descriptor de sistema)
   356                                                                                      ; TIPO = 1111 (Puerta de Excepcion de 32 bits 80386 - Trap Gate)
   357 000000CC 1000                        dw H_ISRXX_Handler                          ; 2 bytes - Offset 31-16 - Segmento de referencia al código de la EXCEPTION
   358                                  ; Machine Check
   359                                  ISR18_IDT   EQU $-IDT   
   360 000000CE [0000]                      dw L_ISR18_Handler_MC                       ; 2 bytes - Offset 15-0 - Segmento de referencia al código de la EXCEPTION 
   361 000000D0 1000                        dw CS_SEL_00                                ; 2 bytes - Selector de segmento de código
   362                                  
   363 000000D2 00                          db 00000000b                                ; 1 byte - 000 e indefinido
   364 000000D3 8F                          db 10001111b                                ; 1 byte - Atributos
   365                                                                                      ; P = 1 (Presente en el segmento)
   366                                                                                      ; DPL = 00 (Nivel de privilegio priotidad Kernel)
   367                                                                                      ; S = 0 (Descriptor de sistema)
   368                                                                                      ; TIPO = 1111 (Puerta de Excepcion de 32 bits 80386 - Trap Gate)
   369 000000D4 1000                        dw H_ISRXX_Handler                          ; 2 bytes - Offset 31-16 - Segmento de referencia al código de la EXCEPTION
   370                                  ; SIMD Floating-Point Exception
   371                                  ISR19_IDT   EQU $-IDT   
   372 000000D6 [0000]                      dw L_ISR19_Handler_XM                       ; 2 bytes - Offset 15-0 - Segmento de referencia al código de la EXCEPTION 
   373 000000D8 1000                        dw CS_SEL_00                                ; 2 bytes - Selector de segmento de código
   374                                  
   375 000000DA 00                          db 00000000b                                ; 1 byte - 000 e indefinido
   376 000000DB 8F                          db 10001111b                                ; 1 byte - Atributos
   377                                                                                      ; P = 1 (Presente en el segmento)
   378                                                                                      ; DPL = 00 (Nivel de privilegio priotidad Kernel)
   379                                                                                      ; S = 0 (Descriptor de sistema)
   380                                                                                      ; TIPO = 1111 (Puerta de Excepcion de 32 bits 80386 - Trap Gate)
   381 000000DC 1000                        dw H_ISRXX_Handler                          ; 2 bytes - Offset 31-16 - Segmento de referencia al código de la EXCEPTION
   382                                  ; Virtualization Exception (20) hasta Intel reserver. Do not use (31) todo reservado.
   383                                  ISR20to31_idt EQU $-IDT
   384 000000DE 0000000000000000-           times 12 dq 0x0  
   384 000000DE <rept>             
   385                                  ; IRQ0 - Timer tick
   386                                  ISR32_IRQ_0 EQU $-IDT
   387 0000013E [0000]                      dw L_IRQ00_Handler                          ; 2 bytes - Offset 15-0 - Segmento de referencia al código de la EXCEPTION 
   388 00000140 1000                        dw CS_SEL_00                                ; 2 bytes - Selector de segmento de código
   389                                  
   390 00000142 00                          db 00000000b                                ; 1 byte - 000 e indefinido
   391 00000143 8E                          db 10001110b                                ; 1 byte - Atributos
   392                                                                                      ; P = 1 (Presente en el segmento)
   393                                                                                      ; DPL = 00 (Nivel de privilegio priotidad Kernel)
   394                                                                                      ; S = 0 (Descriptor de sistema)
   395                                                                                      ; TIPO = 1110 (Puerta de Interrupción de 32 bits 80386 - Int. Gate)
   396 00000144 1000                        dw H_ISRXX_Handler                          ; 2 bytes - Offset 31-16 - Segmento de referencia al código de la EXCEPTION
   397                                  ; IRQ1 - KBI (Keyboard Interrupt)
   398                                  ISR33_IRQ_1 EQU $-IDT
   399 00000146 [0000]                      dw L_IRQ01_Handler                          ; 2 bytes - Offset 15-0 - Segmento de referencia al código de la EXCEPTION 
   400 00000148 1000                        dw CS_SEL_00                                ; 2 bytes - Selector de segmento de código
   401                                  
   402 0000014A 00                          db 00000000b                                ; 1 byte - 000 e indefinido
   403 0000014B 8E                          db 10001110b                                ; 1 byte - Atributos
   404                                                                                      ; P = 1 (Presente en el segmento)
   405                                                                                      ; DPL = 00 (Nivel de privilegio priotidad Kernel)
   406                                                                                      ; S = 0 (Descriptor de sistema)
   407                                                                                      ; TIPO = 1110 (Puerta de Interrupción de 32 bits 80386 - Int. Gate)
   408 0000014C 1000                        dw H_ISRXX_Handler                          ; 2 bytes - Offset 31-16 - Segmento de referencia al código de la EXCEPTION
   409                                  
   410                                  ISR34to46_idt EQU $-IDT   
   411 0000014E 0000000000000000-           times 13 dq 0x0000  ;Usuario
   411 0000014E <rept>             
   412                                         
   413                                  ISER47to127_idt EQU $ - IDT
   414 000001B6 0000000000000000-           times 81 dq 0x0000
   414 000001B6 <rept>             
   415                                  
   416                                  ; Compuerta de interrupción de system call.
   417                                  ISER128_idt EQU $ - IDT
   418 0000043E [0000]                      dw L_ISR128_Handler_SC              ;Offset 15-0
   419 00000440 1000                        dw CS_SEL_00                       ;Selector.
   420 00000442 00                          db 0x00                             ;No usado.
   421 00000443 EE                          db 0xEE                             ;Compuerta de interrupción. DPL = 11
   422 00000444 1000                        dw H_ISRXX_Handler                  ;Offset 31-16
   423                                  
   424                                  
   425                                  IDT_LENGTH EQU $-IDT
   426                                  _idtr_32:
   427 00000446 0704                        dw IDT_LENGTH-1
   428 00000448 [3E000000]                  dd IDT       ; Base de la IDT donde termina la GDT para que esten una arriba de la otra en ROM
   429                                  
   430                                  
