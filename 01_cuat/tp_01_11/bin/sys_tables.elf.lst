     1                                  SECTION .sys_tables
     2                                  ; Direcciones LMA y VMA
     3                                  EXTERN __SYS_TABLES_LMA
     4                                  EXTERN __TECLADO_ISR_VMA
     5                                  ; Etiquetas globales
     6                                  GLOBAL  DS_SEL_00
     7                                  GLOBAL  CS_SEL_00
     8                                  GLOBAL  DS_SEL_11
     9                                  GLOBAL  CS_SEL_11
    10                                  GLOBAL  TSS_SEL
    11                                  GLOBAL  _gdtr_32
    12                                  GLOBAL  _idtr_32
    13                                  ; Parte baja de direcciones de los handlers
    14                                  EXTERN L_ISR00_Handler_DE
    15                                  EXTERN L_ISR01_Handler_DB
    16                                  EXTERN L_ISR02_Handler_NMI
    17                                  EXTERN L_ISR03_Handler_BP
    18                                  EXTERN L_ISR04_Handler_OF
    19                                  EXTERN L_ISR05_Handler_BR
    20                                  EXTERN L_ISR06_Handler_UD
    21                                  EXTERN L_ISR07_Handler_NM
    22                                  EXTERN L_ISR08_Handler_DF
    23                                  EXTERN L_ISR10_Handler_TS
    24                                  EXTERN L_ISR11_Handler_NP
    25                                  EXTERN L_ISR12_Handler_SS
    26                                  EXTERN L_ISR13_Handler_GP
    27                                  EXTERN L_ISR14_Handler_PF
    28                                  EXTERN L_ISR16_Handler_MF
    29                                  EXTERN L_ISR17_Handler_AC
    30                                  EXTERN L_ISR18_Handler_MC
    31                                  EXTERN L_ISR19_Handler_XM
    32                                  EXTERN L_IRQ00_Handler
    33                                  EXTERN L_IRQ01_Handler
    34                                  EXTERN L_ISR128_Handler_SC
    35                                  ; Parte alta de las direcciones de los Handlers
    36                                  H_ISRXX_Handler     EQU 0x0010
    37                                  
    38                                  ;-------------------GDT 32 BITS ----------------
    39                                  ;Cada descriptor tiene 8 bytes.
    40                                  GDT_32:
    41                                  NULL_SEL    equ $-GDT_32       ;Indice de GDT = 0x00
    42 00000000 0000000000000000            dq 0x0
    43                                  CS_SEL_00   equ $-GDT_32       ;Indice de GDT = 0x10
    44 00000008 FFFF                        dw 0xFFFF       ;Limit 15-0
    45 0000000A 0000                        dw 0x0000       ;Base 15-0
    46 0000000C 00                          db 0x00         ;Base 23-16
    47 0000000D 99                          db 10011001b    ;Atributos:                   
    48                                                          ;P=1 Presente en el segmento
    49                                                          ;DPL=00 Privilegio nivel 0 - Kernel
    50                                                          ;S=1 Descriptor de Codigo/Datos        
    51                                                          ;D/C=1 Segmento de Codigo 
    52                                                          ;C=0 No puede ser invocado
    53                                                          ;R=0 No legible
    54                                                          ;A=1 por defecto Accedido
    55 0000000E CF                          db 11001111b    ;Limit 19-16 (Parte baja)
    56                                                      ;Parte alta:
    57                                                          ;G=1 Maximo offset = Limite*0x1000+0xFFF
    58                                                          ;D/B=1 Big, Segmento de 32
    59                                                          ;L=0 No 64 bits nativo
    60                                                          ;AVL=0 No utilizado
    61 0000000F 00                          db 0x00         ;Base
    62                                  DS_SEL_00      equ $-GDT_32       ;Indice de GDT = 0x20
    63 00000010 FFFF                        dw 0xFFFF       ;Limit 15-0
    64 00000012 0000                        dw 0x0000       ;Base 15-0
    65 00000014 00                          db 0x00         ;Base 23-16
    66 00000015 92                          db 10010010b    ;Atributos:
    67                                                          ;P=1 Presente en el segmento
    68                                                          ;DPL=00 Privilegio nivel 0 - Kernel
    69                                                          ;S=1 Descriptor de Codigo/Datos                        
    70                                                          ;D/C=0 Segmento de Datos 
    71                                                          ;ED=0 Segmento de datos comun
    72                                                          ;W=1 Escribible
    73                                                          ;A=0 por defecto No Accedido
    74 00000016 CF                          db 11001111b    ;Limit
    75                                                      ;G
    76                                                      ;D/B
    77                                                      ;L
    78                                                      ;AVL
    79 00000017 00                          db 0x00         ;Base
    80                                  
    81                                  CS_SEL_11      equ $-GDT_32       ;Indice de GDT = 0x30
    82 00000018 FFFF                        dw 0xFFFF       ;Limit 15-0
    83 0000001A 0000                        dw 0x0000       ;Base 15-0
    84 0000001C 00                          db 0x00         ;Base 23-16
    85 0000001D FA                          db 11111010b    ;Atributos:
    86                                                          ;P=1 Presente en el segmento
    87                                                          ;DPL=11   nivel 3 - Usuario
    88                                                          ;S=1 Descriptor de Codigo/Datos                        
    89                                                          ;D/C=1 Segmento de CÃ³digo 
    90                                                          ;ED=0 Segmento de datos comun
    91                                                          ;R=1 Legible
    92                                                          ;A=0 por defecto No Accedido
    93 0000001E CF                          db 11001111b    ;Limit
    94                                                      ;G
    95                                                      ;D/B
    96                                                      ;L
    97                                                      ;AVL
    98 0000001F 00                          db 0x00         ;Base
    99                                  
   100                                  
   101                                  DS_SEL_11      equ $-GDT_32       ;Indice de GDT = 0x20
   102 00000020 FFFF                        dw 0xFFFF       ;Limit 15-0
   103 00000022 0000                        dw 0x0000       ;Base 15-0
   104 00000024 00                          db 0x00         ;Base 23-16
   105 00000025 F2                          db 11110010b    ;Atributos:
   106                                                          ;P=1 Presente en el segmento
   107                                                          ;DPL=00 Privilegio nivel 0 - Kernel
   108                                                          ;S=1 Descriptor de Codigo/Datos                        
   109                                                          ;D/C=0 Segmento de Datos 
   110                                                          ;ED=0 Segmento de datos comun
   111                                                          ;W=1 Escribible
   112                                                          ;A=0 por defecto No Accedido
   113 00000026 CF                          db 11001111b    ;Limit
   114                                                      ;G
   115                                                      ;D/B
   116                                                      ;L
   117                                                      ;AVL
   118 00000027 00                          db 0x00         ;Base
   119                                  
   120                                  
   121                                  TSS_SEL equ $-GDT_32          ;Base 0x00001000 Limite 0x00000067
   122 00000028 6700                        dw  0x0067                ;Limite del segmento(bits 15 -0)
   123 0000002A 0000                        dw  0x0000                ;Base del segmento(bits 15-0)
   124 0000002C 00                          db  0                     ;Base del segmento(bits 23-16)
   125 0000002D 89                          db  10001001b             ; Atributos
   126                                                                    ; P=1 Presente en el segmento
   127                                                                    ; DPL = 00 Privilegio nivel 0 - Kernel
   128                                                                    ; S = 0 (Descriptor de TSS)
   129                                                                    ; TIPO = 1 0 B 1 siendo B = Busy y queda en 0 (Avaibable)
   130 0000002E 00                          db  00000000b             ; G = 0, D/B = 0, L = 0 , AVL = 0 
   131                                                                ; LÃ­mite del segmento (bits 16 - 19)
   132 0000002F 40                          db  0x40                  ; Base del segmento(bits 31-24)    
   133                                  
   134                                  
   135                                  GDT_LENGTH EQU $-GDT_32
   136                                  
   137                                  _gdtr_32:
   138 00000030 2F00                        dw GDT_LENGTH-1
   139                                      ;dd 0x000FFD00 ; Base de la GDT en la section sys_tables. No van todas FFF al principio por el shadow.  
   140 00000032 [00000000]                  dd GDT_32 ; Base de la GDT en la section sys_tables. Use o32 cuando la cargo en init16.  
   141                                  
   142                                  
   143                                  ;-------------------------IDT 32 BITS---------------------
   144                                  
   145                                  ; Cada descriptor tiene 8 bytes.
   146                                  IDT:
   147                                  ; Divide Error
   148                                  ISR00_IDT   EQU $-IDT   
   149 00000036 [0000]                      dw L_ISR00_Handler_DE                       ; 2 bytes - Offset 15-0 - Segmento de referencia al cÃ³digo de la EXCEPTION 
   150                                  
   151 00000038 0800                        dw CS_SEL_00                                ; 2 bytes - Selector de segmento de cÃ³digo
   152                                  
   153 0000003A 00                          db 00000000b                                ; 1 byte - 000 e indefinido
   154 0000003B 8F                          db 10001111b                                ; 1 byte - Atributos
   155                                                                                      ; P = 1 (Presente en el segmento)
   156                                                                                      ; DPL = 00 (Nivel de privilegio priotidad Kernel)
   157                                                                                      ; S = 0 (Descriptor de sistema)
   158                                                                                      ; TIPO = 1111 (Puerta de Excepcion de 32 bits 80386 - Trap Gate)
   159 0000003C 1000                        dw H_ISRXX_Handler       ; 2 bytes - Offset 31-16 - Segmento de referencia al cÃ³digo de la EXCEPTION 
   160                                  ; Debug Exceptions - Reservada 
   161                                  ISR01_IDT   EQU $-IDT   
   162 0000003E 0000000000000000            dq 0x0
   163                                  ; NMI
   164                                  ISR02_IDT   EQU $-IDT   
   165                                  
   166 00000046 [0000]                      dw L_ISR02_Handler_NMI                      ; 2 bytes - Offset 15-0 - Segmento de referencia al cÃ³digo de la EXCEPTION 
   167 00000048 0800                        dw CS_SEL_00                                ; 2 bytes - Selector de segmento de cÃ³digo
   168                                  
   169 0000004A 00                          db 00000000b                                ; 1 byte - 000 e indefinido
   170 0000004B 8F                          db 10001111b                                ; 1 byte - Atributos
   171                                                                                      ; P = 1 (Presente en el segmento)
   172                                                                                      ; DPL = 00 (Nivel de privilegio priotidad Kernel)
   173                                                                                      ; S = 0 (Descriptor de sistema)
   174                                                                                      ; TIPO = 1111 (Puerta de Excepcion de 32 bits 80386 - Trap Gate)
   175 0000004C 1000                        dw H_ISRXX_Handler                          ; 2 bytes - Offset 31-16 - Segmento de referencia al cÃ³digo de la EXCEPTION 
   176                                  ; Breakpoint
   177                                  ISR03_IDT   EQU $-IDT   
   178 0000004E [0000]                      dw L_ISR03_Handler_BP                       ; 2 bytes - Offset 15-0 - Segmento de referencia al cÃ³digo de la EXCEPTION 
   179 00000050 0800                        dw CS_SEL_00                                ; 2 bytes - Selector de segmento de cÃ³digo
   180                                  
   181 00000052 00                          db 00000000b                                ; 1 byte - 000 e indefinido
   182 00000053 8F                          db 10001111b                                ; 1 byte - Atributos
   183                                                                                      ; P = 1 (Presente en el segmento)
   184                                                                                      ; DPL = 00 (Nivel de privilegio priotidad Kernel)
   185                                                                                      ; S = 0 (Descriptor de sistema)
   186                                                                                      ; TIPO = 1111 (Puerta de Excepcion de 32 bits 80386 - Trap Gate)
   187 00000054 1000                        dw H_ISRXX_Handler                           ; 2 bytes - Offset 31-16 - Segmento de referencia al cÃ³digo de la EXCEPTION 
   188                                  ; Overflow
   189                                  ISR04_IDT   EQU $-IDT   
   190 00000056 [0000]                      dw L_ISR04_Handler_OF                       ; 2 bytes - Offset 15-0 - Segmento de referencia al cÃ³digo de la EXCEPTION 
   191 00000058 0800                        dw CS_SEL_00                                ; 2 bytes - Selector de segmento de cÃ³digo
   192                                  
   193 0000005A 00                          db 00000000b                                ; 1 byte - 000 e indefinido
   194 0000005B 8F                          db 10001111b                                ; 1 byte - Atributos
   195                                                                                      ; P = 1 (Presente en el segmento)
   196                                                                                      ; DPL = 00 (Nivel de privilegio priotidad Kernel)
   197                                                                                      ; S = 0 (Descriptor de sistema)
   198                                                                                      ; TIPO = 1111 (Puerta de Excepcion de 32 bits 80386 - Trap Gate)
   199 0000005C 1000                        dw H_ISRXX_Handler                          ; 2 bytes - Offset 31-16 - Segmento de referencia al cÃ³digo de la EXCEPTION 
   200                                  ; BOUND Range Exceeded
   201                                  ISR05_IDT   EQU $-IDT   
   202 0000005E [0000]                      dw L_ISR05_Handler_BR                       ; 2 bytes - Offset 15-0 - Segmento de referencia al cÃ³digo de la EXCEPTION 
   203 00000060 0800                        dw CS_SEL_00                                ; 2 bytes - Selector de segmento de cÃ³digo
   204                                  
   205 00000062 00                          db 00000000b                                ; 1 byte - 000 e indefinido
   206 00000063 8F                          db 10001111b                                ; 1 byte - Atributos
   207                                                                                      ; P = 1 (Presente en el segmento)
   208                                                                                      ; DPL = 00 (Nivel de privilegio priotidad Kernel)
   209                                                                                      ; S = 0 (Descriptor de sistema)
   210                                                                                      ; TIPO = 1111 (Puerta de Excepcion de 32 bits 80386 - Trap Gate)
   211 00000064 1000                        dw H_ISRXX_Handler                          ; 2 bytes - Offset 31-16 - Segmento de referencia al cÃ³digo de la EXCEPTION 
   212                                  ; Invalid Opcode (Undefined Opcode)
   213                                  ISR06_IDT   EQU $-IDT   
   214 00000066 [0000]                      dw L_ISR06_Handler_UD                       ; 2 bytes - Offset 15-0 - Segmento de referencia al cÃ³digo de la EXCEPTION 
   215 00000068 0800                        dw CS_SEL_00                                ; 2 bytes - Selector de segmento de cÃ³digo
   216                                  
   217 0000006A 00                          db 00000000b                                ; 1 byte - 000 e indefinido
   218 0000006B 8F                          db 10001111b                                ; 1 byte - Atributos
   219                                                                                      ; P = 1 (Presente en el segmento)
   220                                                                                      ; DPL = 00 (Nivel de privilegio priotidad Kernel)
   221                                                                                      ; S = 0 (Descriptor de sistema)
   222                                                                                      ; TIPO = 1111 (Puerta de Excepcion de 32 bits 80386 - Trap Gate)
   223 0000006C 1000                        dw H_ISRXX_Handler                          ; 2 bytes - Offset 31-16 - Segmento de referencia al cÃ³digo de la EXCEPTION 
   224                                  ; Device Not Available (No Math Coprocessor)
   225                                  ISR07_IDT   EQU $-IDT   
   226 0000006E [0000]                      dw L_ISR07_Handler_NM                       ; 2 bytes - Offset 15-0 - Segmento de referencia al cÃ³digo de la EXCEPTION 
   227 00000070 0800                        dw CS_SEL_00                                ; 2 bytes - Selector de segmento de cÃ³digo
   228                                  
   229 00000072 00                          db 00000000b                                ; 1 byte - 000 e indefinido
   230 00000073 8F                          db 10001111b                                ; 1 byte - Atributos
   231                                                                                      ; P = 1 (Presente en el segmento)
   232                                                                                      ; DPL = 00 (Nivel de privilegio priotidad Kernel)
   233                                                                                      ; S = 0 (Descriptor de sistema)
   234                                                                                      ; TIPO = 1111 (Puerta de Excepcion de 32 bits 80386 - Trap Gate)
   235 00000074 1000                        dw H_ISRXX_Handler                          ; 2 bytes - Offset 31-16 - Segmento de referencia al cÃ³digo de la EXCEPTION
   236                                  ; Double Fault
   237                                  ISR08_IDT   EQU $-IDT   
   238 00000076 [0000]                      dw L_ISR08_Handler_DF                       ; 2 bytes - Offset 15-0 - Segmento de referencia al cÃ³digo de la EXCEPTION 
   239 00000078 0800                        dw CS_SEL_00                                ; 2 bytes - Selector de segmento de cÃ³digo
   240                                  
   241 0000007A 00                          db 00000000b                                ; 1 byte - 000 e indefinido
   242 0000007B 8F                          db 10001111b                                ; 1 byte - Atributos
   243                                                                                      ; P = 1 (Presente en el segmento)
   244                                                                                      ; DPL = 00 (Nivel de privilegio priotidad Kernel)
   245                                                                                      ; S = 0 (Descriptor de sistema)
   246                                                                                      ; TIPO = 1111 (Puerta de Excepcion de 32 bits 80386 - Trap Gate)
   247 0000007C 1000                        dw H_ISRXX_Handler                          ; 2 bytes - Offset 31-16 - Segmento de referencia al cÃ³digo de la EXCEPTION
   248                                  ; Coprocessor Segment Overrun (reserved)
   249                                  ISR09_IDT   EQU $-IDT   
   250 0000007E 0000000000000000            dq 0x0
   251                                  ; Invalid TSS
   252                                  ISR10_IDT   EQU $-IDT   
   253 00000086 [0000]                      dw L_ISR10_Handler_TS                       ; 2 bytes - Offset 15-0 - Segmento de referencia al cÃ³digo de la EXCEPTION 
   254 00000088 0800                        dw CS_SEL_00                                ; 2 bytes - Selector de segmento de cÃ³digo
   255                                  
   256 0000008A 00                          db 00000000b                                ; 1 byte - 000 e indefinido
   257 0000008B 8F                          db 10001111b                                ; 1 byte - Atributos
   258                                                                                      ; P = 1 (Presente en el segmento)
   259                                                                                      ; DPL = 00 (Nivel de privilegio priotidad Kernel)
   260                                                                                      ; S = 0 (Descriptor de sistema)
   261                                                                                      ; TIPO = 1111 (Puerta de Excepcion de 32 bits 80386 - Trap Gate)
   262 0000008C 1000                        dw H_ISRXX_Handler                          ; 2 bytes - Offset 31-16 - Segmento de referencia al cÃ³digo de la EXCEPTION
   263                                  ; Segment Not Present
   264                                  ISR11_IDT   EQU $-IDT   
   265 0000008E [0000]                      dw L_ISR11_Handler_NP                       ; 2 bytes - Offset 15-0 - Segmento de referencia al cÃ³digo de la EXCEPTION 
   266 00000090 0800                        dw CS_SEL_00                                ; 2 bytes - Selector de segmento de cÃ³digo
   267                                  
   268 00000092 00                          db 00000000b                                ; 1 byte - 000 e indefinido
   269 00000093 8F                          db 10001111b                                ; 1 byte - Atributos
   270                                                                                      ; P = 1 (Presente en el segmento)
   271                                                                                      ; DPL = 00 (Nivel de privilegio priotidad Kernel)
   272                                                                                      ; S = 0 (Descriptor de sistema)
   273                                                                                      ; TIPO = 1111 (Puerta de Excepcion de 32 bits 80386 - Trap Gate)
   274 00000094 1000                        dw H_ISRXX_Handler                          ; 2 bytes - Offset 31-16 - Segmento de referencia al cÃ³digo de la EXCEPTION
   275                                  ; Stack-Segment Fault
   276                                  ISR12_IDT   EQU $-IDT   
   277 00000096 [0000]                      dw L_ISR12_Handler_SS                       ; 2 bytes - Offset 15-0 - Segmento de referencia al cÃ³digo de la EXCEPTION 
   278 00000098 0800                        dw CS_SEL_00                                ; 2 bytes - Selector de segmento de cÃ³digo
   279                                  
   280 0000009A 00                          db 00000000b                                ; 1 byte - 000 e indefinido
   281 0000009B 8F                          db 10001111b                                ; 1 byte - Atributos
   282                                                                                      ; P = 1 (Presente en el segmento)
   283                                                                                      ; DPL = 00 (Nivel de privilegio priotidad Kernel)
   284                                                                                      ; S = 0 (Descriptor de sistema)
   285                                                                                      ; TIPO = 1111 (Puerta de Excepcion de 32 bits 80386 - Trap Gate)
   286 0000009C 1000                        dw H_ISRXX_Handler                          ; 2 bytes - Offset 31-16 - Segmento de referencia al cÃ³digo de la EXCEPTION
   287                                  ; General Protection
   288                                  ISR13_IDT   EQU $-IDT   
   289 0000009E [0000]                      dw L_ISR13_Handler_GP                       ; 2 bytes - Offset 15-0 - Segmento de referencia al cÃ³digo de la EXCEPTION 
   290 000000A0 0800                        dw CS_SEL_00                                ; 2 bytes - Selector de segmento de cÃ³digo
   291                                  
   292 000000A2 00                          db 00000000b                                ; 1 byte - 000 e indefinido
   293 000000A3 8F                          db 10001111b                                ; 1 byte - Atributos
   294                                                                                      ; P = 1 (Presente en el segmento)
   295                                                                                      ; DPL = 00 (Nivel de privilegio priotidad Kernel)
   296                                                                                      ; S = 0 (Descriptor de sistema)
   297                                                                                      ; TIPO = 1111 (Puerta de Excepcion de 32 bits 80386 - Trap Gate)
   298 000000A4 1000                        dw H_ISRXX_Handler                          ; 2 bytes - Offset 31-16 - Segmento de referencia al cÃ³digo de la EXCEPTION
   299                                  ; Page Fault
   300                                  ISR14_IDT   EQU $-IDT   
   301 000000A6 [0000]                      dw L_ISR14_Handler_PF                       ; 2 bytes - Offset 15-0 - Segmento de referencia al cÃ³digo de la EXCEPTION 
   302 000000A8 0800                        dw CS_SEL_00                                ; 2 bytes - Selector de segmento de cÃ³digo
   303                                  
   304 000000AA 00                          db 00000000b                                ; 1 byte - 000 e indefinido
   305 000000AB 8F                          db 10001111b                                ; 1 byte - Atributos
   306                                                                                      ; P = 1 (Presente en el segmento)
   307                                                                                      ; DPL = 00 (Nivel de privilegio priotidad Kernel)
   308                                                                                      ; S = 0 (Descriptor de sistema)
   309                                                                                      ; TIPO = 1111 (Puerta de Excepcion de 32 bits 80386 - Trap Gate)
   310 000000AC 1000                        dw H_ISRXX_Handler                          ; 2 bytes - Offset 31-16 - Segmento de referencia al cÃ³digo de la EXCEPTION
   311                                  ; (Intel reserved. Do not use.)
   312                                  ISR15_IDT   EQU $-IDT   
   313 000000AE 0000000000000000            dq 0x0
   314                                  ; x87 FPU Floating-Point Error (Math Fault)
   315                                  ISR16_IDT   EQU $-IDT   
   316 000000B6 [0000]                      dw L_ISR16_Handler_MF                       ; 2 bytes - Offset 15-0 - Segmento de referencia al cÃ³digo de la EXCEPTION 
   317 000000B8 0800                        dw CS_SEL_00                                ; 2 bytes - Selector de segmento de cÃ³digo
   318                                  
   319 000000BA 00                          db 00000000b                                ; 1 byte - 000 e indefinido
   320 000000BB 8F                          db 10001111b                                ; 1 byte - Atributos
   321                                                                                      ; P = 1 (Presente en el segmento)
   322                                                                                      ; DPL = 00 (Nivel de privilegio priotidad Kernel)
   323                                                                                      ; S = 0 (Descriptor de sistema)
   324                                                                                      ; TIPO = 1111 (Puerta de Excepcion de 32 bits 80386 - Trap Gate)
   325 000000BC 1000                        dw H_ISRXX_Handler                          ; 2 bytes - Offset 31-16 - Segmento de referencia al cÃ³digo de la EXCEPTION
   326                                  ; Alignment Check
   327                                  ISR17_IDT   EQU $-IDT   
   328 000000BE [0000]                      dw L_ISR17_Handler_AC                       ; 2 bytes - Offset 15-0 - Segmento de referencia al cÃ³digo de la EXCEPTION 
   329 000000C0 0800                        dw CS_SEL_00                                ; 2 bytes - Selector de segmento de cÃ³digo
   330                                  
   331 000000C2 00                          db 00000000b                                ; 1 byte - 000 e indefinido
   332 000000C3 8F                          db 10001111b                                ; 1 byte - Atributos
   333                                                                                      ; P = 1 (Presente en el segmento)
   334                                                                                      ; DPL = 00 (Nivel de privilegio priotidad Kernel)
   335                                                                                      ; S = 0 (Descriptor de sistema)
   336                                                                                      ; TIPO = 1111 (Puerta de Excepcion de 32 bits 80386 - Trap Gate)
   337 000000C4 1000                        dw H_ISRXX_Handler                          ; 2 bytes - Offset 31-16 - Segmento de referencia al cÃ³digo de la EXCEPTION
   338                                  ; Machine Check
   339                                  ISR18_IDT   EQU $-IDT   
   340 000000C6 [0000]                      dw L_ISR18_Handler_MC                       ; 2 bytes - Offset 15-0 - Segmento de referencia al cÃ³digo de la EXCEPTION 
   341 000000C8 0800                        dw CS_SEL_00                                ; 2 bytes - Selector de segmento de cÃ³digo
   342                                  
   343 000000CA 00                          db 00000000b                                ; 1 byte - 000 e indefinido
   344 000000CB 8F                          db 10001111b                                ; 1 byte - Atributos
   345                                                                                      ; P = 1 (Presente en el segmento)
   346                                                                                      ; DPL = 00 (Nivel de privilegio priotidad Kernel)
   347                                                                                      ; S = 0 (Descriptor de sistema)
   348                                                                                      ; TIPO = 1111 (Puerta de Excepcion de 32 bits 80386 - Trap Gate)
   349 000000CC 1000                        dw H_ISRXX_Handler                          ; 2 bytes - Offset 31-16 - Segmento de referencia al cÃ³digo de la EXCEPTION
   350                                  ; SIMD Floating-Point Exception
   351                                  ISR19_IDT   EQU $-IDT   
   352 000000CE [0000]                      dw L_ISR19_Handler_XM                       ; 2 bytes - Offset 15-0 - Segmento de referencia al cÃ³digo de la EXCEPTION 
   353 000000D0 0800                        dw CS_SEL_00                                ; 2 bytes - Selector de segmento de cÃ³digo
   354                                  
   355 000000D2 00                          db 00000000b                                ; 1 byte - 000 e indefinido
   356 000000D3 8F                          db 10001111b                                ; 1 byte - Atributos
   357                                                                                      ; P = 1 (Presente en el segmento)
   358                                                                                      ; DPL = 00 (Nivel de privilegio priotidad Kernel)
   359                                                                                      ; S = 0 (Descriptor de sistema)
   360                                                                                      ; TIPO = 1111 (Puerta de Excepcion de 32 bits 80386 - Trap Gate)
   361 000000D4 1000                        dw H_ISRXX_Handler                          ; 2 bytes - Offset 31-16 - Segmento de referencia al cÃ³digo de la EXCEPTION
   362                                  ; Virtualization Exception (20) hasta Intel reserver. Do not use (31) todo reservado.
   363                                  ISR20to31_idt EQU $-IDT
   364 000000D6 0000000000000000-           times 12 dq 0x0  
   364 000000D6 <rept>             
   365                                  ; IRQ0 - Timer tick
   366                                  ISR32_IRQ_0 EQU $-IDT
   367 00000136 [0000]                      dw L_IRQ00_Handler                          ; 2 bytes - Offset 15-0 - Segmento de referencia al cÃ³digo de la EXCEPTION 
   368 00000138 0800                        dw CS_SEL_00                                ; 2 bytes - Selector de segmento de cÃ³digo
   369                                  
   370 0000013A 00                          db 00000000b                                ; 1 byte - 000 e indefinido
   371 0000013B 8E                          db 10001110b                                ; 1 byte - Atributos
   372                                                                                      ; P = 1 (Presente en el segmento)
   373                                                                                      ; DPL = 00 (Nivel de privilegio priotidad Kernel)
   374                                                                                      ; S = 0 (Descriptor de sistema)
   375                                                                                      ; TIPO = 1110 (Puerta de InterrupciÃ³n de 32 bits 80386 - Int. Gate)
   376 0000013C 1000                        dw H_ISRXX_Handler                          ; 2 bytes - Offset 31-16 - Segmento de referencia al cÃ³digo de la EXCEPTION
   377                                  ; IRQ1 - KBI (Keyboard Interrupt)
   378                                  ISR33_IRQ_1 EQU $-IDT
   379 0000013E [0000]                      dw L_IRQ01_Handler                          ; 2 bytes - Offset 15-0 - Segmento de referencia al cÃ³digo de la EXCEPTION 
   380 00000140 0800                        dw CS_SEL_00                                ; 2 bytes - Selector de segmento de cÃ³digo
   381                                  
   382 00000142 00                          db 00000000b                                ; 1 byte - 000 e indefinido
   383 00000143 8E                          db 10001110b                                ; 1 byte - Atributos
   384                                                                                      ; P = 1 (Presente en el segmento)
   385                                                                                      ; DPL = 00 (Nivel de privilegio priotidad Kernel)
   386                                                                                      ; S = 0 (Descriptor de sistema)
   387                                                                                      ; TIPO = 1110 (Puerta de InterrupciÃ³n de 32 bits 80386 - Int. Gate)
   388 00000144 1000                        dw H_ISRXX_Handler                          ; 2 bytes - Offset 31-16 - Segmento de referencia al cÃ³digo de la EXCEPTION
   389                                  
   390                                  ISR34to46_idt EQU $-IDT   
   391 00000146 0000000000000000-           times 13 dq 0x0000  ;Usuario
   391 00000146 <rept>             
   392                                         
   393                                  ISER47to127_idt EQU $ - IDT
   394 000001AE 0000000000000000-           times 81 dq 0x0000
   394 000001AE <rept>             
   395                                  
   396                                  ; Compuerta de interrupciÃ³n de system call.
   397                                  ISER128_idt EQU $ - IDT
   398 00000436 [0000]                      dw L_ISR128_Handler_SC              ;Offset 15-0
   399 00000438 0800                        dw CS_SEL_00                       ;Selector.
   400 0000043A 00                          db 0x00                             ;No usado.
   401 0000043B EE                          db 0xEE                             ;Compuerta de interrupciÃ³n. DPL = 11
   402 0000043C 1000                        dw H_ISRXX_Handler                  ;Offset 31-16
   403                                  
   404                                  
   405                                  IDT_LENGTH EQU $-IDT
   406                                  _idtr_32:
   407 0000043E 0704                        dw IDT_LENGTH-1
   408 00000440 [36000000]                  dd IDT       ; Base de la IDT donde termina la GDT para que esten una arriba de la otra en ROM
   409                                  
   410                                  
